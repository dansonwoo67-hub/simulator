<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sales Commission Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.8; padding: 20px; }
    h1 { color: darkblue; }
    h2 { color: green; font-weight: bold; }
    .result { color: green; font-weight: bold; }
    .highlight { color: red; font-weight: bold; }
    .hidden { display: none; }
    .disclaimer { 
      background-color: #fff3cd; 
      border: 2px solid #ffc107; 
      padding: 15px; 
      margin: 20px 0; 
      border-radius: 5px;
      color: #856404;
      font-weight: bold;
    }
    .warning { 
      background-color: #f8d7da; 
      border: 2px solid #dc3545; 
      padding: 10px; 
      margin: 10px 0; 
      border-radius: 5px;
      color: #721c24;
      font-weight: bold;
      text-align: center;
    }
    input, button { margin: 5px; padding: 5px; }
    .dream-text { 
      background-color: #f0f8ff; 
      padding: 15px; 
      border-left: 4px solid #007bff; 
      margin: 10px 0; 
      line-height: 1.6;
    }
    .arabic-text {
      color: #d4af37;
      font-weight: bold;
      font-style: italic;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    table, th, td {
      border: 1px solid #999;
      padding: 6px;
      text-align: center;
    }
    th {
      background-color: #007bff;
      color: white;
    }
  </style>
</head>
<body>
  <div class="disclaimer">
    ‚ö†Ô∏è <strong>IMPORTANT DISCLAIMER:</strong><br>
    This is a SIMULATION TOOL ONLY for educational and planning purposes. 
    All calculations are estimates and DO NOT represent actual company policies, 
    real commission rates, or guaranteed payments. 
    For official commission information, please consult your manager or HR department.
  </div>

  <div id="loginBox">
    <h2>Login Required</h2>
    <p>Username: <input type="text" id="username"></p>
    <p>Password: <input type="password" id="password"></p>
    <button onclick="login()">Login</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <div id="content" class="hidden">
    <h1>Sales Commission Calculator - SIMULATION ONLY</h1>
    
    <div class="warning">
      üö® THIS IS A SIMULATION - NOT REAL COMMISSION DATA üö®
    </div>

    <h2>üìä Current Commission Simulation (EXAMPLE ONLY)</h2>
    <div class="warning">These numbers are NOT your actual commission!</div>
    <p>Individual Net Contract Count: <input type="number" id="personalContracts"></p>
    <p>Actual Revenue (USD): <input type="number" id="actualCash"></p>
    <button onclick="calculateCurrent()">Calculate SIMULATED Commission</button>
    <div id="currentResult"></div>

    <h2>üéØ Target Commission Simulation (HYPOTHETICAL)</h2>
    <div class="warning">This is practice calculation - not company policy!</div>
    <p>Package A (75 pk): <input type="number" id="pk75" value="0"></p>
    <p>Package B (90 pk): <input type="number" id="pk90" value="0"></p>
    <p>Package C (105 pk): <input type="number" id="pk105" value="0"></p>
    <p>Package D (150 pk): <input type="number" id="pk150" value="0"></p>
    <p>Package E (225 pk): <input type="number" id="pk225" value="0"></p>
    <p>Package F (300 pk): <input type="number" id="pk300" value="0"></p>
    <p>Package G (375 pk): <input type="number" id="pk375" value="0"></p>
    <button onclick="calculateTarget()">Calculate renew pk Target</button>
    <div id="targetResult"></div>

    <h2>üí≠ Dream Commission Simulation (FANTASY PLANNING)</h2>
    <div class="warning">This is motivational planning tool - not real calculations!</div>
    <p>Enter your dream monthly commission (EGP): <input type="number" id="dreamAmount"></p>
    <button onclick="calculateDream()">Calculate HYPOTHETICAL Dream Path</button>
    <div id="dreamResult"></div>

    <!-- 4Ô∏è‚É£ Excel Upload Commission Calculation -->
    <h2>üìÇ Batch Commission Calculation (via Excel Upload)</h2>
    <div class="warning">Upload your Excel file with columns: EA CRM name | contract | cash-usd</div>
    <input type="file" id="excelFile" accept=".xlsx">
    <button onclick="processExcel()">Upload & Calculate</button>
    <div id="excelResult"></div>

    <div class="disclaimer">
      <strong>FINAL REMINDER:</strong><br>
      ‚úÖ This tool is for SIMULATION and MOTIVATION only<br>
      ‚úÖ All numbers are EXAMPLES and NOT GUARANTEES<br>
      ‚úÖ Real commission depends on actual company policies<br>
      ‚úÖ Always verify with your manager for official information<br>
      ‚ùå DO NOT use these calculations for financial decisions
    </div>

    <p style="text-align:center; color:#888; font-size:12px;">Designed by Danson Wu ¬∑ EGSS-07</p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script>
    // Login
    function login() {
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;
      if (user === "EGEA" && pass === "unstopable") {
        document.getElementById("loginBox").classList.add("hidden");
        document.getElementById("content").classList.remove("hidden");
        alert("‚ö†Ô∏è REMINDER: This is a SIMULATION tool only. All calculations are examples, not real commission data!");
      } else {
        document.getElementById("loginError").innerText = "Wrong username or password!";
      }
    }

    const exchangeRate = 48.22;

    const commissionTiers = [
      { contracts: 0, rate: 0.000 },
      { contracts: 4, rate: 0.010 },
      { contracts: 7, rate: 0.015 },
      { contracts: 10, rate: 0.020 },
      { contracts: 15, rate: 0.025 },
      { contracts: 20, rate: 0.030 },
      { contracts: 25, rate: 0.035 },
      { contracts: 30, rate: 0.040 },
      { contracts: 40, rate: 0.050 }
    ];

    const packagePrices = {
      75: 660, 90: 720, 105: 800, 150: 1020, 225: 1460, 300: 1820, 375: 2080
    };

    function getRateByContracts(n) {
      let rate = 0;
      for (let i = 0; i < commissionTiers.length; i++) {
        if (n >= commissionTiers[i].contracts) rate = commissionTiers[i].rate;
      }
      return rate;
    }

    function getNextThreshold(n) {
      for (let i = 0; i < commissionTiers.length; i++) {
        if (commissionTiers[i].contracts > n) return commissionTiers[i].contracts;
      }
      return null;
    }

    function calculateCurrent() {
      const contracts = parseInt(document.getElementById("personalContracts").value);
      const cash = parseFloat(document.getElementById("actualCash").value);
      if (isNaN(contracts) || isNaN(cash)) {
        alert("Please enter both values");
        return;
      }
      
      const rate = getRateByContracts(contracts);
      const commission = cash * rate * exchangeRate;

      const next = getNextThreshold(contracts);
      let nextMsg = "";
      if (next) {
        const need = next - contracts;
        const futureRate = getRateByContracts(next);
        const futureCommission = cash * futureRate * exchangeRate;
        nextMsg = `<p class="result">SIMULATION: If you get ${need} more contracts (total ${next}), rate ${(futureRate * 100).toFixed(1)}%, estimated <span class="highlight">${futureCommission.toFixed(2)} EGP</span></p>`;
      }

      document.getElementById("currentResult").innerHTML = `
        <div class="warning">‚ö†Ô∏è SIMULATION RESULTS - NOT REAL COMMISSION ‚ö†Ô∏è</div>
        <p class="result">Contracts: <span class="highlight">${contracts}</span></p>
        <p class="result">Rate: <span class="highlight">${(rate * 100).toFixed(1)}%</span></p>
        <p class="result">Commission: <span class="highlight">${commission.toFixed(2)} EGP</span></p>
        ${nextMsg}
      `;
    }

    function calculateTarget() {
      const packages = [75, 90, 105, 150, 225, 300, 375];
      let contracts = 0, revenue = 0;
      packages.forEach(pkg => {
        const qty = parseInt(document.getElementById("pk" + pkg).value) || 0;
        contracts += qty;
        revenue += qty * packagePrices[pkg];
      });
      const rate = getRateByContracts(contracts);
      const commission = revenue * rate * exchangeRate;

      document.getElementById("targetResult").innerHTML = `
        <div class="warning">‚ö†Ô∏è HYPOTHETICAL CALCULATION ONLY ‚ö†Ô∏è</div>
        <p class="result">Contracts: <span class="highlight">${contracts}</span></p>
        <p class="result">Rate: <span class="highlight">${(rate * 100).toFixed(1)}%</span></p>
        <p class="result">Commission: <span class="highlight">${commission.toFixed(2)} EGP</span></p>
      `;
    }

    function calculateDream() {
      const dreamAmount = parseFloat(document.getElementById("dreamAmount").value);
      if (isNaN(dreamAmount) || dreamAmount <= 0) {
        alert("Please enter your dream commission amount");
        return;
      }

      const dreamUSD = dreamAmount / exchangeRate;
      const avgRate = 0.035;
      const neededRevenue = dreamUSD / avgRate;
      const pk300 = Math.ceil(neededRevenue * 0.4 / packagePrices[300]);
      const pk150 = Math.ceil(neededRevenue * 0.3 / packagePrices[150]);
      const pk225F = Math.ceil(neededRevenue * 0.2 / (packagePrices[225] * 3));
      const pk150F = Math.ceil(neededRevenue * 0.1 / (packagePrices[150] * 3));
      const totalDeals = pk300 + pk150 + pk225F + pk150F;
      const calls = Math.min(Math.max(Math.ceil(totalDeals * 4 / 26), 30), 60);

      const total2Years = dreamAmount * 24;
      const property = total2Years / 200000;

      document.getElementById("dreamResult").innerHTML = `
        <div class="dream-text">
          <p>üí∞ To earn ${dreamAmount.toLocaleString()} EGP/month:</p>
          <p>‚Ä¢ ${pk300} √ó 300min</p><p>‚Ä¢ ${pk150} √ó 150min</p>
          <p>‚Ä¢ ${pk225F} √ó family225 | ${pk150F} √ó family150</p>
          <p>Daily valid calls: <span class="highlight">${calls}</span></p>
          <p>2 years saving = ${total2Years.toLocaleString()} EGP (~${property.toFixed(1)} Cairo flats)</p>
        </div>`;
    }

    function processExcel() {
      const fileInput = document.getElementById('excelFile');
      const file = fileInput.files[0];
      if (!file) { alert("Please upload an Excel file first."); return; }

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(sheet);
        let html = "<h3>üìä Batch Commission Results</h3><table><tr><th>EA Name</th><th>Contracts</th><th>Cash (USD)</th><th>Rate</th><th>Commission (EGP)</th></tr>";
        rows.forEach(r => {
          const n = r["EA CRM name"] || "N/A";
          const c = Number(r["contract"]) || 0;
          const usd = Number(r["cash-usd"]) || 0;
          const rate = getRateByContracts(c);
          const com = usd * rate * exchangeRate;
          html += `<tr><td>${n}</td><td>${c}</td><td>${usd.toFixed(2)}</td><td>${(rate*100).toFixed(1)}%</td><td>${com.toLocaleString(undefined,{maximumFractionDigits:2})}</td></tr>`;
        });
        html += "</table>";
        document.getElementById('excelResult').innerHTML = html;
      };
      reader.readAsArrayBuffer(file);
    }
  </script>
</body>
</html>
